import{r as v,j as e,a as o,T as A,q as T,s as S,t as x,I as k,S as C,M as b,v as O,w as R,x as W,B as D,p as M,m as F,y as E,z as _,A as j,C as w,E as G,u as H,P as z,N as Q,F as K,H as J,d as U,J as Y,K as X,L as Z,Q as ee,e as ae,D as te,n as le,o as ne,g as re,i as se,h as oe,k as ce,l as $,f as L,U as ie,V as ue,G as de}from"./index-Cf0SbAd0.js";import{E as he}from"./EmployeeModelClone-B5er9R1W.js";const I={blank:[],string:["contains","equals","starts_with","ends_with"],date:["equals","before","after"],number:["equals","greater_than","less_than"],select:["equals","not_equals"],multiselect:["includes_all","includes_any","excludes"],boolean:["equals"]},me=(c,r)=>{if(c==="blank")return!0;if(r===""||r===null||r===void 0)return!1;switch(c){case"text":return typeof r=="string";case"date":return!Number.isNaN(Date.parse(r));case"number":return!Number.isNaN(parseFloat(r));case"select":return typeof r=="string";case"multiselect":return Array.isArray(r);case"boolean":return typeof r=="boolean";default:return!1}};function pe(c){const r=[];function i(u,d=""){for(const s in u)if(u.hasOwnProperty(s)){const m=u[s],t=d?`${d}.${s}`:s,y=typeof m;r.push({name:t,type:y}),typeof m=="object"&&m!==null&&i(m,t)}}return i(c),r.push({name:"",type:"blank"}),r}function ye({fields:c,onSubmit:r}){const[i,u]=v.useState([{field:"",operator:"",value:"",type:"blank"}]),[d,s]=v.useState([]);v.useState("");const[m,t]=v.useState([]),y=()=>{u([...i,{field:"",operator:"",value:"",type:"blank"}]),t([...m,""]),i.length>0&&s([...d,"AND"])},N=l=>{const n=i.filter((g,p)=>p!==l),a=d.filter((g,p)=>p!==l-1),h=m.filter((g,p)=>p!==l);u(n),s(a),t(h)},f=(l,n,a)=>{const h=[...i];if(n==="field"){const p=c.find(B=>B.name===a);h[l]={field:a,operator:p.type==="blank"?"":I[p.type][0],value:p.type==="multiselect"?[]:"",type:p.type}}else h[l]={...h[l],[n]:a};u(h);const g=[...m];g[l]="",t(g)},V=(l,n)=>{const a=[...d];a[l]=n,s(a)},P=l=>{l.preventDefault();const n=i.filter(h=>me(h.type,h.value)),a=n.map((h,g)=>({field:h.field,operator:h.operator,value:h.value,...g<n.length-1?{nextOperator:d[g]}:{}}));r(JSON.stringify(a,null,2))},q=(l,n)=>{switch(l.type){case"blank":return null;case"date":return e(E,{type:"date",label:"Date",value:l.value,onChange:a=>f(n,"value",a.target.value),fullWidth:!0,InputLabelProps:{shrink:!0}});case"number":return e(E,{type:"number",label:"Value",value:l.value,onChange:a=>f(n,"value",a.target.value),fullWidth:!0});case"select":return o(x,{fullWidth:!0,children:[e(k,{children:"Value"}),e(C,{value:l.value,label:"Value",onChange:a=>f(n,"value",a.target.value),children:c.find(a=>a.name===l.field).options.map(a=>e(b,{value:a,children:a},a))})]});case"multiselect":return o(x,{fullWidth:!0,children:[e(k,{children:"Value"}),e(C,{multiple:!0,value:l.value,onChange:a=>f(n,"value",a.target.value),input:e(j,{label:"Value"}),renderValue:a=>a.join(", "),children:c.find(a=>a.name===l.field).options.map(a=>o(b,{value:a,children:[e(w,{checked:l.value.indexOf(a)>-1}),e(G,{primary:a})]},a))})]});case"boolean":return o(x,{fullWidth:!0,children:[e(A,{component:"label",htmlFor:`boolean-switch-${n}`,children:"Value"}),e(_,{id:`boolean-switch-${n}`,checked:l.value,onChange:a=>f(n,"value",a.target.checked),inputProps:{"aria-label":"Boolean value"}})]});default:return e(E,{type:"text",label:"Value",value:l.value,onChange:a=>f(n,"value",a.target.value),fullWidth:!0})}};return e(F.div,{className:"flex flex-col flex-shrink rounded-lg",initial:{opacity:0,x:20},animate:{opacity:1,x:0,transition:{delay:.2}},children:o(M,{className:"overflow-scroll rounded-b-0 w-full h-full max-h-240",elevation:3,sx:{p:3,mb:"10px",mx:"auto",width:"200px"},children:[e(A,{className:"text-2xl font-extrabold leading-none tracking-tight",gutterBottom:!0,children:"Advanced Search"}),o("form",{onSubmit:P,children:[i.map((l,n)=>o(T,{sx:{mb:2},children:[o(S,{container:!0,spacing:2,alignItems:"center",children:[e(S,{item:!0,xs:12,sm:3,children:o(x,{fullWidth:!0,children:[e(k,{children:"Field"}),e(C,{value:l.field,label:"Field",onChange:a=>f(n,"field",a.target.value),children:c.map(a=>e(b,{value:a.name,children:a.name},a.name))})]})}),e(S,{item:!0,xs:12,sm:3,children:o(x,{fullWidth:!0,children:[e(k,{children:"Operator"}),e(C,{value:l.operator,label:"Operator",onChange:a=>f(n,"operator",a.target.value),children:I[l.type].map(a=>e(b,{value:a,children:a},a))})]})}),e(S,{item:!0,xs:12,sm:4,children:q(l,n)}),o(S,{item:!0,xs:12,sm:2,children:[e(O,{onClick:y,title:"add",children:e(R,{})}),n>0&&e(O,{onClick:()=>N(n),color:"error",children:e(W,{})})]})]}),n<i.length-1&&e(T,{sx:{display:"flex",justifyContent:"center",my:1},children:e(x,{children:o(C,{value:d[n],onChange:a=>V(n,a.target.value),displayEmpty:!0,children:[e(b,{value:"AND",children:"AND"}),e(b,{value:"OR",children:"OR"})]})})})]},n)),e(D,{type:"submit",variant:"contained",color:"primary",children:"Search"})]})]})})}function fe({handleSwitch:c}){const r=H(s=>s.breakpoints.down("lg")),[i,u]=v.useState(!1),d=s=>{c(s.target.checked),u(s.target.checked)};return o("div",{className:"flex grow-0  flex-1 w-full items-center justify-between  space-y-8 sm:space-y-0 py-24 sm:py-32",children:[e(F.span,{initial:{x:-20},animate:{x:0,transition:{delay:.2}},children:o("div",{children:[e(z,{className:"mb-8"}),e(A,{className:"text-4xl font-extrabold leading-none tracking-tight",children:"Employees"})]})}),e("div",{className:"flex flex-1 items-center justify-end space-x-8",children:o(F.div,{className:"flex flex-grow-0",initial:{opacity:0,x:20},animate:{opacity:1,x:0,transition:{delay:.2}},children:[o(D,{className:"",variant:"contained",color:"secondary",component:Q,to:"/apps/employees/employeesSearch/new",size:r?"small":"medium",children:[e(K,{size:20,children:"heroicons-outline:plus"}),e("span",{className:"mx-4 sm:mx-8",children:"Add"})]}),e(J,{className:"ml-4",control:e(_,{checked:i,onChange:d,inputProps:{"aria-label":"controlled"}}),label:"Advance Search"})]})})]})}function ge(){const c=U(),{data:r,isLoading:i,refetch:u}=Y(void 0,{refetchOnMountOrArgChange:!0}),[d]=X();v.useEffect(()=>{u()},[u]);const s=t=>{c(ne({children:o(L,{children:[e(re,{id:"alert-dialog-title",children:"Are you sure you want to delete this Employee ?"}),e(oe,{children:e(se,{id:"alert-dialog-description",children:"You are going to remove selected Employee. Are you sure you want to continue?"})}),o(ce,{className:"p-16",children:[e(D,{onClick:()=>{c($())},color:"warning",children:"Cancel"}),e(D,{onClick:async()=>{c($()),await d({id:t}),u()},color:"primary",autoFocus:!0,children:"Yes"})]})]})}))},m=v.useMemo(()=>[{accessorKey:"employeeNumber",header:"Employee Number",accessorFn:t=>`${t.employeeNumber}`},{accessorKey:"name",header:"Name",Cell:({row:t})=>{var y,N;return e(A,{component:Z,to:`/apps/employees/employeesSearch/${t.original.id}`,className:"underline",color:"secondary",role:"button",children:`${(y=t.original)==null?void 0:y.firstName}  ${(N=t.original)==null?void 0:N.lastName}`})}},{accessorKey:"email",header:"Email",accessorFn:t=>`${t==null?void 0:t.email}`},{accessorKey:"phoneNumber",header:"Phone Number",accessorFn:t=>`${t==null?void 0:t.phoneNumber}`},{accessorKey:"gender",header:"Gender",accessorFn:t=>`${t==null?void 0:t.gender}`},{accessorKey:"departmentName",header:"Department",accessorFn:t=>`${t==null?void 0:t.departmentName}`},{accessorKey:"designationName",header:"Designation",accessorFn:t=>`${t==null?void 0:t.designationName}`},{accessorKey:"employeeCategory",header:"Category",accessorFn:t=>`${t==null?void 0:t.categoryName}`},{accessorKey:"site",header:"Site",accessorFn:t=>`${t==null?void 0:t.site}`},{accessorKey:"hireDate",header:"Hire Date",accessorFn:t=>ee(new Date(t.hireDate),"dd/MM/yyyy")}],[]);return i?e(ae,{}):e(M,{className:"flex flex-col flex-auto shadow-1 rounded-t-lg overflow-hidden rounded-b-0 w-full h-full",elevation:0,children:e(te,{enableMultiRemove:!1,data:r,columns:m,renderRowActionMenuItems:({closeMenu:t,row:y,table:N})=>[o(b,{onClick:()=>{s(y.original.id),t(),N.resetRowSelection()},children:[e(le,{children:e(K,{children:"heroicons-outline:trash"})}),"Delete"]},0)]})})}function Ne(){const r=ie(s=>s.user).role;console.log("role is ",r);const[i]=ue(),[u,d]=v.useState(!1);return o(L,{children:[e(de,{styles:()=>({"#root":{maxHeight:"100vh"}})}),o("div",{className:"w-full h-full flex flex-col px-16",children:[e(fe,{handleSwitch:s=>d(s)}),u&&e(ye,{onSubmit:s=>i({body:s}),fields:pe(he({}))}),e(ge,{})]})]})}export{Ne as default};
